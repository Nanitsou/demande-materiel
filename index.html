<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Concept Energies ‚Äì Demande de mat√©riel</title>

<style>
:root{
  --accent:#16f2c3;
  --accent2:#00cfa3;
  --text:#eafff9;
  --muted:#9bded0;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:system-ui, Arial, sans-serif;
  background: linear-gradient(180deg,#0f2f2b,#071c1a);
  color:var(--text);
  display:flex;
  justify-content:center;
  padding:20px;
  min-height:100vh;
}

.app{
  backdrop-filter: blur(4px);
  width:460px;
  max-width:100%;
  background:rgba(15,22,32,.85);
  border-radius:20px;
  border:1px solid rgba(22,242,195,.45);
  box-shadow:0 0 35px rgba(22,242,195,.25);
  padding:20px;
}

/* LOGO */
.logo{
  width:300px;
  max-width:95%;
  display:block;
  margin:14px auto 18px;
  filter: drop-shadow(0 0 12px rgba(22,242,195,.45));
}

/* TEXT */
.subtitle{
  text-align:center;
  color:var(--muted);
  font-size:13px;
  margin-bottom:14px;
}

/* FORM */
label{
  display:block;
  margin-top:14px;
  font-size:14px;
}

input, textarea, select{
  width:100%;
  margin-top:6px;
  padding:11px;
  border-radius:10px;
  border:none;
  background:#0a1317;
  color:white;
  font-size:14px;
}

textarea{
  resize:none;
  height:80px;
}

/* BUTTONS */
button{
  margin-top:14px;
  width:100%;
  padding:13px;
  border-radius:14px;
  border:none;
  font-size:16px;
  font-weight:800;
  cursor:pointer;
}

.btn-main{
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  color:#002b22;
}

.btn-secondary{
  background:#0a1317;
  color:var(--text);
  border:1px solid rgba(22,242,195,.3);
}

.btn-danger{
  background:#3a0d0d;
  color:#fff;
  border:1px solid rgba(255,80,80,.6);
}

button:hover{opacity:.9;}

.note{
  margin-top:12px;
  font-size:12px;
  color:var(--muted);
  text-align:center;
}
</style>
</head>

<body>

<div class="app">

  <img src="logo.png" class="logo" alt="Concept Energies">

  <div class="subtitle">
    Demande de mat√©riel chantier ‚Äì WhatsApp
  </div>

  <label>Ouvrier</label>
  <input id="worker" placeholder="Nom de l'ouvrier">

  <label>Chantier</label>
  <input id="site" placeholder="Nom ou num√©ro du chantier">

  <label>Type de mat√©riel</label>
  <select id="type">
    <option>C√¢bles</option>
    <option>Tableau √©lectrique</option>
    <option>Disjoncteurs</option>
    <option>Gaines</option>
    <option>√âclairage</option>
    <option>Outillage</option>
    <option>Autre</option>
  </select>

  <label>Urgence</label>
  <button type="button" id="urgentBtn" class="btn-secondary">
    üö® Urgence : NON
  </button>

  <label>D√©tail / quantit√©</label>
  <textarea id="details" placeholder="Ex : c√¢ble 3G2.5 ‚Äì 100m"></textarea>

  <button type="button" class="btn-main" id="sendBtn">
    üì≤ Envoyer la demande (WhatsApp)
  </button>

  <div class="note">
    La demande est enregistr√©e dans Sheets + envoy√©e sur WhatsApp.
  </div>

</div>

<!-- ‚úÖ Formulaire invisible pour Google Sheets (anti-CORS) -->
<form id="sheetForm"
      action="https://script.google.com/macros/s/AKfycbweJyEAeDt7-ECYEMxHe0t2WSFhMMnIwRrIKuiagdmYaBuK_IUc77BnIDfn0jRGT4-rJA/exec"
      method="POST"
      target="hiddenFrame">
  <input type="hidden" name="worker">
  <input type="hidden" name="site">
  <input type="hidden" name="type">
  <input type="hidden" name="details">
  <input type="hidden" name="urgent">
</form>
<iframe name="hiddenFrame" style="display:none;"></iframe>

<script>
const PHONE = "352621515160"; // WhatsApp sans +
let urgent = false;

const urgentBtn = document.getElementById("urgentBtn");
urgentBtn.addEventListener("click", () => {
  urgent = !urgent;
  urgentBtn.textContent = urgent ? "üö® Urgence : OUI (aujourd‚Äôhui)" : "üö® Urgence : NON";
  urgentBtn.className = urgent ? "btn-danger" : "btn-secondary";
});

document.getElementById("sendBtn").addEventListener("click", () => {
  const worker = document.getElementById("worker").value.trim();
  const site = document.getElementById("site").value.trim();
  const type = document.getElementById("type").value;
  const details = document.getElementById("details").value.trim();

  if(!worker || !site || !details){
    alert("Merci de remplir tous les champs.");
    return;
  }

  // 1) Envoi Google Sheets via FORM (fiable, pas de CORS)
  const form = document.getElementById("sheetForm");
  form.elements["worker"].value = worker;
  form.elements["site"].value = site;
  form.elements["type"].value = type;
  form.elements["details"].value = details;
  form.elements["urgent"].value = urgent ? "OUI" : "NON";
  form.submit();

  // 2) WhatsApp
  const lines = [
    "‚ö° DEMANDE MATERIEL ‚Äì CONCEPT ENERGIES",
    urgent ? "üö® URGENT AUJOURD‚ÄôHUI" : "",
    `üë∑ Ouvrier : ${worker}`,
    `üèóÔ∏è Chantier : ${site}`,
    `üì¶ Type : ${type}`,
    `üìù D√©tail : ${details}`,
    `üïí ${new Date().toLocaleString()}`
  ].filter(Boolean);

  const url = "https://wa.me/" + PHONE + "?text=" + encodeURIComponent(lines.join("\n"));
  window.open(url, "_blank");
});
</script>

</body>
</html>

